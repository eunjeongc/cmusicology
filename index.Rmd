---
title: "Portfolio for Computational Musicology 2024"
author: Sally Choi
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r setup, include=FALSE}
library(flexdashboard)
```

```{r}
library(tidyverse)
library(spotifyr)
library(compmus)
library(plotly)
library(gridExtra)
```


### About my corpus
As an international student from South Korea, my passion for K-pop extends beyond the contemporary music of my time to include that of the preceding millennium. Over the years, I have observed the transformative changes in K-pop, influenced by advancements in production techniques and the forces of globalization. Notably, the growing collaborations between K-pop and Western artists have resulted in a fusion of diverse musical genres. In particular, I anticipate “Millennium K-pop” and “K-pop ON!” playlists to reveal distinct differences in musical components, including the tempo and rhythm, instrumentation trends, and melodic content. Upon reviewing the Spotify-curated playlists, I can conclude that both collections feature tracks that defined their respective eras. It is also important to acknowledge that both playlists maintain consistency by exclusively featuring music from K-pop groups without incorporating other genres like K-hip-hop or K-indie. However, a notable difference lies in the playlist sizes; the “Millennium K-pop” playlist consists of 100 tracks, while “K-pop ON!” features 50 tracks. For the analysis to have a more balanced comparison, it would be beneficial to augment the tracks from the millennium. In conclusion, my objective is to enhance my understanding of how K-pop has evolved by comparing the two playlists on Spotify, each representing different temporal frames - the millennium and the present.

*** 

<iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DWUoY6Ih7vsxr?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

### Do more people listen to K-pop now than before?
```{r}
kpop_mill <- get_playlist_audio_features("", "2d9N60Iz8yzdsWLP1crgd2")
kpop_on <- get_playlist_audio_features("", "1y6ywhJxaBAjAQ6Ybmg0kg")
```

```{r}
kpop <-
  bind_rows(
    kpop_mill |> mutate(category = "Millennium"),
    kpop_on |> mutate(category = "ON!")
  )
```

```{r}
ggplot1 <- ggplot(kpop, aes(
  x = tempo, y = danceability, color = track.popularity, text = track.name)) + 
  geom_point() +
  scale_color_continuous(name = "Popularity", trans = "reverse") + 
  theme_light() +
  labs(title = "Relationship between Tempo and Danceability: K-pop Millennium vs. K-pop ON!", x = "Tempo", y = "Danceability") + 
  facet_grid(. ~ playlist_name, scales = "fixed") 

ggplotly(ggplot1)
```


***
In exploring the relationship between danceability and tempo within the playlists "K-pop ON!" and "Millennium K-pop," it is evident that while no strong correlation exists between the two variables, danceability tends to increase with higher tempo. Additionally, the color-coded points on the scatter plot reveal that current K-pop tracks exhibit significantly higher popularity compared to tracks in the Millennium playlist. However, the correlation between track popularity and danceability remains unclear, as no definitive relationship has been established.

### Is there a noteable difference in the distribution of tempo and danceability between the two playlists?
```{r}
tempo <- ggplot(kpop, aes(
  x = tempo)) + 
  geom_histogram(binwidth = 10) +
  theme_light() +
  labs(title = "Distribution of Tempo", x = "Tempo") + 
  facet_grid(. ~ playlist_name, scales = "fixed")
```

```{r}
danceability <- ggplot(kpop, aes(
  x = danceability)) + 
  geom_histogram(binwidth = 0.030) +
  theme_light() +
  labs(title = "Distribution of Danceability", x = "Danceability") + 
  facet_grid(. ~ playlist_name, scales = "fixed")
```

```{r}
grid.arrange(tempo, danceability, ncol=2)
```

***
For a more detailed comparison between the two playlists, histograms were created to visualize the distribution of danceability and tempo. While danceability values remain relatively similar between the two playlists, there is a notable shift in tempo. In the Millennium playlist, there is a distinct preference for a specific tempo, whereas contemporary tracks display a more diverse range, resembling a more symmetrical distribution.

### Chromagram
```{r}
jungkook <-
  get_tidy_audio_analysis("2KslE17cAJNHTsI2MI0jb2") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
```

```{r}
jungkook_chrom <- 
  jungkook |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "Chromagram of Standing Next to You", x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

```{r}
wgirls <-
  get_tidy_audio_analysis("2UuKZDzjZ7cVMOvpmuAMYj") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
```

```{r}
wgirls_chrom <- 
  wgirls |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = "Chromagram of Tell Me", x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

```{r}
grid.arrange(jungkook_chrom, wgirls_chrom, ncol=1)
```

***
I have extracted the chromagrams of two highly popular tracks from different playlists. The first chromagram represents "Standing Next to You" by Jungkook, featuring dominant notes C#/Db, D, and A. In contrast, the second chromagram depicts "Tell Me" by Wonder Girls, showing dominant notes C#/Db, F#/Gb, and B. A notable distinction emerges when comparing the two: "Standing Next to You" displays a more colorful chromagram, suggesting a diverse range of pitches and a potentially more complex harmonic structure. Furthermore, it appears that "Standing Next to You" has a clearer musical structure, with recurring patterns emphasizing its melodic motifs. It is important to note that these insights are specific to the tracks "Standing Next to You" and "Tell Me" and should not be generalized to comparisons between music from different eras, such as the millennium and the present.

### Two different versions of the same track
```{r}
cupid <-
  get_tidy_audio_analysis("5mg3VB3Qh7jcR5kAAC4DSV") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

cupid_sabrina <-
  get_tidy_audio_analysis("28PCjIXE4NJWDIqpRsD3rl") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
```

```{r}
compmus_long_distance(
  cupid |> mutate(pitches = map(pitches, compmus_normalise, "euclidean")),
  cupid_sabrina |> mutate(pitches = map(pitches, compmus_normalise, "euclidean")),
  feature = pitches,
  method = "cosine"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "Cupid - FIFTY FIFTY", y = "Cupid - FIFTY FIFTY, Sabrina Carpenter", title = "Comparative Chromagram Analysis: Two Versions of 'Cupid'") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)
```

***
For a more in-depth analysis, I compare the chroma vectors of two different versions of the same track. On the x-axis, we have the original song, "Cupid" by FIFTY FIFTY, and on the y-axis, the remixed version featuring Sabrina Carpenter. After experimenting with various combinations of normalization and distance method, the chosen configuration involves the Euclidean normalization method paired with the cosine distance method for the final visualization. Despite the presence of a diagonal line on the graph, it lacks the intensity to indicate a strong correlation between the two versions. Additionally, the checkerboard pattern suggests potential differences between the two tracks. For instance, the remix may introduce additional chords or variations on existing chords, resulting in discrepancies in note magnitude.

### Cepstrograms
```{r}
jungkook_timbre <-
  get_tidy_audio_analysis("2KslE17cAJNHTsI2MI0jb2") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r}
jungkook_timbre |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()
```

```{r}
wgirls_timbre <-
  get_tidy_audio_analysis("2UuKZDzjZ7cVMOvpmuAMYj") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r}
wgirls_timbre |>
  compmus_gather_timbre() |>
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()
```

***
In this comparison, I analyze the cepstrograms of two tracks from the playlists "K-pop ON!" and K-pop Millennium." Upon examining the visualizations, a notable distinction emerges between "Standing Next to You" and "Tell Me." The cepstrogram of "Standing Next to You" reveals a diverse magnitude spectrum, indicating in a broad range of instrumentation in use. On the other hand, "Tell Me" exhibits a consistent color frame throughout the song, indicative of a relatively uniform timbre.

Although there are several potential reasons for these observations, one could be that the advancements in musical technology over the years have enabled producers to incorporate a wider variety of sounds into their compositions. Such technological progress contributes to the diverse magnitude seen in "Standing Next to You." Moreover, the consistent timbre in "Tell Me" may be attributed to the track's relatively simple and repeating musical structure, lacking significant deviations from its main melodic line.
